<mujoco model="turtlebot3_burger">
  <compiler angle="degree" meshdir="/home/juyoung/mujoco_llm/asset/robotis_tb3/assets" autolimits="true"/>

  <option integrator="implicitfast"/>

  <visual>
  <rgba rangefinder="0 0 1 0.1"/>
  </visual>

  <!-- Default -->
  <default>
    <joint limited="false" armature="0.01" />
    <!-- rolling joint -->
    <equality solref="0.0002 1" solimp="0.99 0.99 0.0001" />
  </default>

  <asset>
    <mesh name="burger_base" file="burger_base.stl" scale="0.001 0.001 0.001"/>
    <mesh name="left_tire" file="left_tire.stl" scale="0.001 0.001 0.001"/>
    <mesh name="right_tire" file="right_tire.stl" scale="0.001 0.001 0.001"/>
    <mesh name="lds" file="lds.stl" scale="0.001 0.001 0.001"/>
    <!-- 센서용 mesh 추가 -->
    <mesh name="camera"    file="camera.stl"/>
    <mesh name="lidar"     file="lidar.stl"     scale="0.001 0.001 0.001"/>
    <mesh name="ul_sensor" file="ul_sensor.stl"/>
  </asset>

  <worldbody>
    <body name="base" pos="0 0 0" euler="0 0 0">
      <joint type="free" name="base_joint"/>
      <geom pos="-0.032 0 0.01" type="mesh" rgba="0.4 0.4 0.4 1" mesh="burger_base"/>
      <geom size="0.015 0.0045 0.01" pos="-0.081 7.96327e-07 0.005" quat="0.707388 -0.706825 0 0" type="box"/>
      <geom pos="-0.032 0 0.182" quat="1 0 0 0" type="mesh" rgba="0.3 0.3 0.3 1" mesh="lds"/>
      <body name="wheel_left_link" pos="0 0.08 0.033" quat="0.707388 -0.706825 0 0">
        <inertial pos="0 0 0" quat="-0.000890159 0.706886 0.000889646 0.707326" mass="0.0284989" diaginertia="2.07126e-05 1.11924e-05 1.11756e-05"/>
        <joint name="wheel_left_joint" pos="0 0 0" axis="0 0 1"/>
        <geom quat="0.707388 0.706825 0 0" type="mesh" rgba="0.3 0.3 0.3 1" mesh="left_tire"/>
      </body>
      <body name="wheel_right_link" pos="0 -0.08 0.033" quat="0.707388 -0.706825 0 0">
        <inertial pos="0 0 0" quat="-0.000890159 0.706886 0.000889646 0.707326" mass="0.0284989" diaginertia="2.07126e-05 1.11924e-05 1.11756e-05"/>
        <joint name="wheel_right_joint" pos="0 0 0" axis="0 0 1"/>
        <geom quat="0.707388 0.706825 0 0" type="mesh" rgba="0.3 0.3 0.3 1" mesh="right_tire"/>
      </body>
            <!-- IMU -->
      <body name="imu_link" pos="0 0 0.05">
        <site name="imu" pos="0 0 0"/>
      </body>

      <!-- 카메라 (앞쪽에 장착) -->
      <body name="camera_mount" pos="0.05 0 0.15">
        <body name="camera_link" pos="0 0 0">
          <geom type="mesh" mesh="camera" rgba="0.31 0.64 0.41 1.0" pos="0 0 0"/>
          <camera
              name="camera"
              mode="fixed"
              fovy="60"
              xyaxes="0 -1 0 0 0 1"/>
        </body>
      </body>

      <!-- LiDAR (lds 위에 딱 얹기) -->
      <body name="lidar_mount" pos="-0.032 0 0.172">
        <body name="laser_link" pos="0 0 0">
          <geom type="mesh" mesh="lidar" rgba="0.1 0.1 0.1 1" pos="0 0 0"/>
          <replicate count="360" euler="0 0 1">
            <site name="rf"
                  size="0.001 0.001 0.001"
                  rgba="0 0 0 0"
                  pos="0.0 0.0 0.03"
                  zaxis="1 0 0"/>
          </replicate>
        </body>
      </body>

      <!-- 초음파 센서 (앞쪽 아래쪽, 그냥 박스 기하만) -->
      <body name="ul_sensor_mount" pos="0.05 0 0.04">
        <body name="ul_sensor_link" pos="0 0 0">
          <geom type="mesh" mesh="ul_sensor" rgba="0.07 0.34 0.63 1.0" pos="0 0 0"/>
        </body>
      </body>
    </body>
  </worldbody>

  <sensor>
    <!-- LiDAR (cutoff 변경)-->
    <rangefinder name="laser" site="rf" cutoff="15.0"/>

    <!-- IMU -->
    <accelerometer name="accelerometer" site="imu"/>
    <gyro           name="gyro"          site="imu"/>
    <velocimeter    name="velocimeter"   site="imu"/>
  </sensor>

  <!-- Actuator -->
  <actuator>
    <velocity name="wheel_left_actuator" ctrllimited="true" ctrlrange="-30.0 30.0" gear="1" kv="1.0" joint="wheel_left_joint" />
    <velocity name="wheel_right_actuator" ctrllimited="true" ctrlrange="-30.0 30.0" gear="1" kv="1.0" joint="wheel_right_joint" />
  </actuator>
</mujoco>
